--- a/source/fitz/xml.c
+++ b/source/fitz/xml.c
@@ -26,7 +26,9 @@
 #include <stdlib.h>
 #include <stdio.h>
 
+#if FZ_ENABLE_HTML
 #include <gumbo.h>
+#endif
 
 /* #define FZ_XML_SEQ */
 
@@ -867,6 +869,7 @@
 	return xml;
 }
 
+#if FZ_ENABLE_HTML
 /*
 	Parse the contents of buffer into a tree of XML nodes, using the HTML5 syntax.
 
@@ -1021,3 +1024,4 @@
 
 	return xml;
 }
+#endif
